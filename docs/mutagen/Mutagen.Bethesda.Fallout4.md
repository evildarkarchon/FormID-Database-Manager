# Mutagen.Bethesda.Fallout4

Game-specific record types and mod structure for **Fallout 4** plugin files (`.esp`, `.esm`, `.esl`). This project contains mostly **generated** record type definitions created by the Loqui code generator, along with handwritten partial classes that provide custom binary parsing, flags, enums, and special behavior.

**Namespace:** `Mutagen.Bethesda.Fallout4`

---

## Generated Code Pattern

The vast majority of files in this project are **auto-generated by Loqui** (the code generation framework Mutagen uses). Each record type follows a consistent pattern:

### For Each Record Type (e.g., `Npc`)

| Artifact | File | Description |
|----------|------|-------------|
| Mutable class | `Npc_Generated.cs` | `partial class Npc : Fallout4MajorRecord` -- the mutable record with read/write properties |
| Getter interface | `INpcGetter` (in generated file) | Read-only interface for the record |
| Setter interface | `INpc` / `INpcInternal` (in generated file) | Read/write interface for the record |
| Binary overlay | `NpcBinaryOverlay` (in generated file) | Lazy read-only overlay that reads directly from binary data without full deserialization |
| Handwritten partial | `Npc.cs` | Custom enums, flags, binary parsing overrides, and additional properties |
| XML definition | `Npc.xml` | Loqui schema that drives code generation (not compiled) |

### Interface Hierarchy

```
IMajorRecordGetter
  -> IFallout4MajorRecordGetter
    -> INpcGetter              (read-only, used for binary overlays)
    -> INpc / INpcInternal     (read/write, used for mutable records)
```

### Common Aspects

Many records implement shared aspect interfaces:
- `INamedGetter` / `INamed` -- records with a Name field
- `IObjectBoundedGetter` -- records with ObjectBounds
- `IKeywordedGetter<IKeywordGetter>` -- records with Keywords
- `IModeledGetter` -- records with a 3D Model
- `IHaveVirtualMachineAdapterGetter` / `IScriptedGetter` -- records with Papyrus scripts
- `IWeightValueGetter` -- records with Weight and Value
- `IEnchantableGetter` -- records that can have enchantments

### FormLinks

Record references use typed `IFormLink<T>` / `IFormLinkGetter<T>` with the getter interface as the type parameter:
```csharp
IFormLinkNullableGetter<IRaceGetter> Race { get; }
IFormLinkNullableGetter<IVoiceTypeGetter> Voice { get; }
ExtendedList<IFormLinkGetter<IFactionGetter>> Factions { get; }
```

---

## Fallout4Mod Class

**File:** `Records/Fallout4Mod.cs` + `Records/Fallout4Mod_Generated.cs`

The top-level container representing a Fallout 4 plugin file. Inherits from `AMod`.

### Key Properties

| Property | Type | Description |
|----------|------|-------------|
| `ModHeader` | `Fallout4ModHeader` | Plugin header (master list, flags, description, stats) |
| `ModKey` | `ModKey` | The plugin's filename identifier |
| `Fallout4Release` | `Fallout4Release` | The specific Fallout 4 release variant |
| `IsMaster` | `bool` | Whether the plugin is flagged as a master file |
| `IsSmallMaster` | `bool` | Whether the plugin is flagged as a light/small master (ESL) |
| `CanBeSmallMaster` | `bool` | Returns `true` (FO4 supports ESL files) |
| `CanBeMediumMaster` | `bool` | Returns `false` (FO4 does not support medium masters) |
| `ListsOverriddenForms` | `bool` | Returns `true` |
| `OverriddenForms` | `IReadOnlyList<IFormLinkGetter<IMajorRecordGetter>>?` | List of overridden form references |

### Builder API

```csharp
// Read a mod (mutable)
var mod = Fallout4Mod.Create(Fallout4Release.Fallout4)
    .FromPath(modKey, path)
    .Mutable();

// Read a mod (read-only overlay, lazy loading)
using var overlay = Fallout4Mod.Create(Fallout4Release.Fallout4)
    .FromPath(modKey, path)
    .Readonly();

// Write a mod
mod.BeginWrite
    .ToPath(outputPath)
    .WithAutoSplit()     // optional: auto-split into ESL-compatible files
    .Write();
```

### Record Groups (125 groups)

Each group is a `Fallout4Group<T>` providing `RecordCache` access. The full group listing:

| Group Property | Record Type | Description |
|---------------|-------------|-------------|
| `GameSettings` | `GameSetting` | Engine configuration variables (fCombatDistance, etc.) |
| `Keywords` | `Keyword` | Tagging keywords used throughout the game |
| `LocationReferenceTypes` | `LocationReferenceType` | Reference type markers for locations |
| `Actions` | `ActionRecord` | Animation action identifiers |
| `Transforms` | `Transform` | 3D transform presets |
| `Components` | `Component` | Crafting/settlement components |
| `TextureSets` | `TextureSet` | Multi-texture definitions (diffuse, normal, etc.) |
| `Globals` | `Global` | Global script variables |
| `DamageTypes` | `ADamageType` | Damage type definitions |
| `Classes` | `Class` | Character class definitions |
| `Factions` | `Faction` | NPC faction affiliations |
| `HeadParts` | `HeadPart` | Character head part options (hair, eyes, etc.) |
| `Races` | `Race` | Race/species definitions |
| `SoundMarkers` | `SoundMarker` | Sound emitter markers |
| `AcousticSpaces` | `AcousticSpace` | Reverb/acoustic environment zones |
| `MagicEffects` | `MagicEffect` | Base magic effect definitions |
| `LandscapeTextures` | `LandscapeTexture` | Terrain texture assignments |
| `ObjectEffects` | `ObjectEffect` | Enchantments applied to items |
| `Spells` | `Spell` | Spell definitions |
| `Activators` | `Activator` | Interactive objects |
| `TalkingActivators` | `TalkingActivator` | Activators that can speak dialogue |
| `Armors` | `Armor` | Armor/clothing definitions |
| `Books` | `Book` | Readable items |
| `Containers` | `Container` | Container objects |
| `Doors` | `Door` | Door objects |
| `Ingredients` | `Ingredient` | Crafting ingredients |
| `Lights` | `Light` | Light source objects |
| `MiscItems` | `MiscItem` | Miscellaneous inventory items |
| `Statics` | `Static` | Static mesh objects |
| `StaticCollections` | `StaticCollection` | Grouped static objects |
| `MovableStatics` | `MovableStatic` | Physics-enabled static objects |
| `Grasses` | `Grass` | Grass/ground cover definitions |
| `Trees` | `Tree` | Tree objects |
| `Florae` | `Flora` | Harvestable plants |
| `Furniture` | `Furniture` | Sittable/usable furniture |
| `Weapons` | `Weapon` | Weapon definitions |
| `Ammunitions` | `Ammunition` | Ammunition types |
| `Npcs` | `Npc` | Non-player character definitions |
| `LeveledNpcs` | `LeveledNpc` | Leveled NPC lists |
| `Keys` | `Key` | Key items |
| `Ingestibles` | `Ingestible` | Consumable items (food, chems, etc.) |
| `IdleMarkers` | `IdleMarker` | Idle animation trigger points |
| `Holotapes` | `Holotape` | Holotape data items |
| `Projectiles` | `Projectile` | Projectile definitions |
| `Hazards` | `Hazard` | Environmental hazards |
| `BendableSplines` | `BendableSpline` | Wire/cable spline definitions |
| `Terminals` | `Terminal` | Computer terminal definitions |
| `LeveledItems` | `LeveledItem` | Leveled item lists |
| `Weather` | `Weather` | Weather type definitions |
| `Climates` | `Climate` | Climate region definitions |
| `ShaderParticleGeometries` | `ShaderParticleGeometry` | Particle shader definitions |
| `VisualEffects` | `VisualEffect` | Visual effect definitions |
| `Regions` | `Region` | World region definitions |
| `NavigationMeshInfoMaps` | `NavigationMeshInfoMap` | Navigation mesh metadata |
| `Worldspaces` | `Worldspace` | World space definitions |
| `Quests` | `Quest` | Quest definitions |
| `IdleAnimations` | `IdleAnimation` | Idle animation definitions |
| `Packages` | `Package` | AI behavior packages |
| `CombatStyles` | `CombatStyle` | Combat behavior styles |
| `LoadScreens` | `LoadScreen` | Loading screen definitions |
| `AnimatedObjects` | `AnimatedObject` | Animated object definitions |
| `Waters` | `Water` | Water type definitions |
| `EffectShaders` | `EffectShader` | Visual shader effects |
| `Explosions` | `Explosion` | Explosion definitions |
| `Debris` | `Debris` | Debris effects |
| `ImageSpaces` | `ImageSpace` | Image space (post-processing) settings |
| `ImageSpaceAdapters` | `ImageSpaceAdapter` | Image space modifier adapters |
| `FormLists` | `FormList` | Generic lists of form references |
| `Perks` | `Perk` | Player/NPC perk definitions |
| `BodyParts` | `BodyPartData` | Body part data for dismemberment |
| `AddonNodes` | `AddonNode` | Addon node definitions |
| `ActorValueInformation` | `ActorValueInformation` | Actor value metadata |
| `CameraShots` | `CameraShot` | Scripted camera angle definitions |
| `CameraPaths` | `CameraPath` | Camera path definitions |
| `VoiceTypes` | `VoiceType` | Voice type identifiers |
| `MaterialTypes` | `MaterialType` | Physical material types |
| `Impacts` | `Impact` | Impact effect definitions |
| `ImpactDataSets` | `ImpactDataSet` | Grouped impact effects |
| `ArmorAddons` | `ArmorAddon` | Armor visual addon definitions |
| `EncounterZones` | `EncounterZone` | Level-scaling encounter zones |
| `Locations` | `Location` | Named location definitions |
| `Messages` | `Message` | UI message definitions |
| `DefaultObjectManagers` | `DefaultObjectManager` | Default object manager records |
| `DefaultObjects` | `DefaultObject` | Default object references |
| `LightingTemplates` | `LightingTemplate` | Interior lighting template definitions |
| `MusicTypes` | `MusicType` | Music type/playlist definitions |
| `Footsteps` | `Footstep` | Footstep sound definitions |
| `FootstepSets` | `FootstepSet` | Footstep set collections |
| `StoryManagerBranchNodes` | `StoryManagerBranchNode` | Story manager branch nodes |
| `StoryManagerQuestNodes` | `StoryManagerQuestNode` | Story manager quest nodes |
| `StoryManagerEventNodes` | `StoryManagerEventNode` | Story manager event nodes |
| `MusicTracks` | `MusicTrack` | Individual music track definitions |
| `DialogViews` | `DialogView` | Dialogue view definitions |
| `EquipTypes` | `EquipType` | Equipment slot type definitions |
| `Relationships` | `Relationship` | NPC relationship definitions |
| `AssociationTypes` | `AssociationType` | Association type definitions |
| `Outfits` | `Outfit` | NPC outfit definitions |
| `ArtObjects` | `ArtObject` | Art/visual object definitions |
| `MaterialObjects` | `MaterialObject` | Material object definitions |
| `MovementTypes` | `MovementType` | NPC movement type definitions |
| `SoundDescriptors` | `SoundDescriptor` | Sound descriptor definitions |
| `SoundCategories` | `SoundCategory` | Sound category definitions |
| `SoundOutputModels` | `SoundOutputModel` | Sound output configuration |
| `CollisionLayers` | `CollisionLayer` | Physics collision layer definitions |
| `Colors` | `ColorRecord` | Color definitions |
| `ReverbParameters` | `ReverbParameters` | Audio reverb parameters |
| `PackIns` | `PackIn` | Pack-In template definitions |
| `ReferenceGroups` | `ReferenceGroup` | Reference group definitions |
| `AimModels` | `AimModel` | Weapon aim model definitions |
| `Layers` | `Layer` | Layer definitions |
| `ConstructibleObjects` | `ConstructibleObject` | Crafting recipe definitions |
| `ObjectModifications` | `AObjectModification` | Weapon/armor modification definitions |
| `MaterialSwaps` | `MaterialSwap` | Material swap definitions |
| `Zooms` | `Zoom` | Weapon zoom/scope definitions |
| `InstanceNamingRules` | `InstanceNamingRules` | Dynamic item naming rules |
| `SoundKeywordMappings` | `SoundKeywordMapping` | Sound keyword mapping definitions |
| `AudioEffectChains` | `AudioEffectChain` | Audio effect chain definitions |
| `SceneCollections` | `SceneCollection` | Scene collection definitions |
| `AttractionRules` | `AttractionRule` | Settlement attraction rules |
| `AudioCategorySnapshots` | `AudioCategorySnapshot` | Audio category snapshot definitions |
| `AnimationSoundTagSets` | `AnimationSoundTagSet` | Animation sound tag sets |
| `NavigationMeshObstacleManagers` | `NavigationMeshObstacleManager` | Navmesh obstacle management |
| `LensFlares` | `LensFlare` | Lens flare definitions |
| `GodRays` | `GodRays` | Volumetric lighting (god ray) definitions |
| `ObjectVisibilityManagers` | `ObjectVisibilityManager` | Object visibility management |

### Parallel Writing

The `Fallout4ModCommon` class provides parallel writing support for complex nested structures:
- `WriteCellsParallel()` -- Parallel serialization of cell block hierarchies
- `WriteWorldspacesParallel()` -- Parallel serialization of worldspace hierarchies
- `WriteQuestsParallel()` -- Parallel serialization of quest groups

---

## Major Record Type Catalog

### Characters and Creatures

| Record Type | Description | Key Fields | Getter Interface |
|-------------|-------------|------------|-----------------|
| `Npc` | Non-player character | Name, Race, Voice, Level, Flags, Class, Factions, Inventory, Morphs, Template | `INpcGetter` |
| `LeveledNpc` | Leveled NPC list | Entries, ChanceNone, Flags | `ILeveledNpcGetter` |
| `Race` | Race / species | Name, Skin, BodyData, HeadData, Morphs, Keywords, BipedObjectNames | `IRaceGetter` |
| `Class` | Character class | Name, TagSkills, Properties | `IClassGetter` |
| `VoiceType` | Voice type | Flags | `IVoiceTypeGetter` |

### Items and Equipment

| Record Type | Description | Key Fields | Getter Interface |
|-------------|-------------|------------|-----------------|
| `Weapon` | Weapon definition | Name, ObjectBounds, Model, Flags, AnimationType, Speed, Reach, Damage, Value, Weight, Keywords, ObjectEffect | `IWeaponGetter` |
| `Armor` | Armor / clothing | Name, ObjectBounds, Model, Flags, ArmorRating, Value, Weight, Keywords, BipedObjectData | `IArmorGetter` |
| `ArmorAddon` | Armor visual addon | Race, BipedObjectData, Model (male/female), AdditionalRaces | `IArmorAddonGetter` |
| `Ammunition` | Ammunition type | Name, Model, Value, Flags, Damage, Projectile | `IAmmunitionGetter` |
| `Book` | Readable item | Name, Model, Value, Weight, Flags, Description, BookText, TeachTarget | `IBookGetter` |
| `Container` | Container object | Name, Model, Flags, Weight, Items | `IContainerGetter` |
| `Ingestible` | Consumable item | Name, Model, Value, Weight, Effects, ConsumeSound | `IIngestibleGetter` |
| `Ingredient` | Crafting ingredient | Name, Model, Value, Weight, Effects | `IIngredientGetter` |
| `Key` | Key item | Name, Model, Value, Weight | `IKeyGetter` |
| `MiscItem` | Miscellaneous item | Name, Model, Value, Weight, Keywords, Components | `IMiscItemGetter` |
| `Holotape` | Holotape data | Name, Model, Flags, HolotapeType (Program/Sound/Terminal/Voice) | `IHolotapeGetter` |
| `LeveledItem` | Leveled item list | Entries, ChanceNone, Flags | `ILeveledItemGetter` |
| `Outfit` | NPC outfit | Items | `IOutfitGetter` |

### World and Environment

| Record Type | Description | Key Fields | Getter Interface |
|-------------|-------------|------------|-----------------|
| `Worldspace` | World space | Name, Climate, Water, Parent, MapData, SubCells, TopCell | `IWorldspaceGetter` |
| `Cell` | Interior/exterior cell | Flags, Lighting, Water, Owner, Persistent/Temporary placed objects, NavigationMeshes, Landscape | `ICellGetter` |
| `Landscape` | Terrain data | VertexHeightMap, Layers | `ILandscapeGetter` |
| `PlacedObject` | Placed reference (REFR) | Base, Position, Rotation, Scale, Owner, EnableParent, Primitive, LinkedReferences | `IPlacedObjectGetter` |
| `PlacedNpc` | Placed NPC (ACHR) | Base, Position, Rotation, Scale, Owner | `IPlacedNpcGetter` |
| `NavigationMesh` | Navmesh | Triangles, Vertices, EdgeLinks | `INavigationMeshGetter` |
| `Region` | World region | Areas, RegionData (objects, weather, map, sounds, grasses) | `IRegionGetter` |
| `Location` | Named location | Name, Keywords, ParentLocation, ActorCellPersistentReference | `ILocationGetter` |
| `EncounterZone` | Level-scaling zone | Owner, Rank, MinLevel, MaxLevel, Flags | `IEncounterZoneGetter` |

### Magic and Effects

| Record Type | Description | Key Fields | Getter Interface |
|-------------|-------------|------------|-----------------|
| `Spell` | Spell definition | Name, Type, CastType, TargetType, CastDuration, Effects, BaseCost | `ISpellGetter` |
| `MagicEffect` | Base magic effect | Name, Flags, BaseCost, Archetype, AssociatedItem, CastingArt | `IMagicEffectGetter` |
| `ObjectEffect` | Item enchantment | Name, CastType, EnchantmentAmount, Effects | `IObjectEffectGetter` |
| `Perk` | Perk definition | Name, Description, Conditions, Effects (Ability/QuestEffect/EntryPoint) | `IPerkGetter` |
| `Hazard` | Environmental hazard | Name, Model, Limit, Radius, Lifetime, ImageSpaceModifier, Light | `IHazardGetter` |

### Quests and Dialogue

| Record Type | Description | Key Fields | Getter Interface |
|-------------|-------------|------------|-----------------|
| `Quest` | Quest definition | Name, Flags, Type, Priority, Stages, Objectives, Aliases, DialogTopics | `IQuestGetter` |
| `DialogTopic` | Dialog topic | Name, Priority, Type, Quest, Responses | `IDialogTopicGetter` |
| `DialogResponses` | Dialog response set | Responses, Conditions, Topic, PreviousDialog, FavorLevel | `IDialogResponsesGetter` |
| `DialogBranch` | Dialog branch | Quest, StartingTopic, Flags | `IDialogBranchGetter` |
| `DialogView` | Dialog view | Quest, Branches | `IDialogViewGetter` |
| `Scene` | Scene definition | Quest, Actors, Actions, Phases | `ISceneGetter` |

### AI and Behavior

| Record Type | Description | Key Fields | Getter Interface |
|-------------|-------------|------------|-----------------|
| `Package` | AI package | Type, Flags, Schedule, Conditions, PackageBranches, PackageData | `IPackageGetter` |
| `CombatStyle` | Combat style | Flags, OffensiveMult, DefensiveMult, MeleeMult, ClosedRangeMult | `ICombatStyleGetter` |
| `Faction` | Faction | Name, Flags, Relations, CrimeValues, VendorValues, Conditions, Ranks | `IFactionGetter` |
| `Relationship` | NPC relationship | Parent, Child, Rank, AssociationType | `IRelationshipGetter` |
| `IdleAnimation` | Idle animation | Conditions, Filename, AnimationGroupSection, ParentIdle | `IIdleAnimationGetter` |

### Audio

| Record Type | Description | Key Fields | Getter Interface |
|-------------|-------------|------------|-----------------|
| `SoundDescriptor` | Sound descriptor | Conditions, LoopAndRumble, OutputModel, StandardData/CompoundData/AutoweaponData | `ISoundDescriptorGetter` |
| `SoundCategory` | Sound category | Name, Flags, ParentCategory, Volume | `ISoundCategoryGetter` |
| `SoundOutputModel` | Sound output model | Flags, Channels, AttenuationValues | `ISoundOutputModelGetter` |
| `SoundMarker` | Sound emitter | SoundDescriptor | `ISoundMarkerGetter` |
| `MusicType` | Music playlist | Flags, Priority, Tracks | `IMusicTypeGetter` |
| `MusicTrack` | Music track | Type, Filename, LoopData, Duration | `IMusicTrackGetter` |
| `AudioEffectChain` | Audio effect chain | Effects (Overdrive, StateVariableFilter, Delay) | `IAudioEffectChainGetter` |
| `AudioCategorySnapshot` | Audio snapshot | Priority, AudioCategoryMultipliers | `IAudioCategorySnapshotGetter` |
| `AcousticSpace` | Acoustic space | AmbientSound, Region, ReverbType | `IAcousticSpaceGetter` |
| `ReverbParameters` | Reverb parameters | DecayTime, ReflectDelay, ReverbDelay, Diffusion, Density | `IReverbParametersGetter` |

### Visual and Rendering

| Record Type | Description | Key Fields | Getter Interface |
|-------------|-------------|------------|-----------------|
| `Static` | Static mesh | Model, Flags, MaxAngle, Material | `IStaticGetter` |
| `StaticCollection` | Static collection | Model, Parts | `IStaticCollectionGetter` |
| `MovableStatic` | Physics-enabled static | Model, Flags | `IMovableStaticGetter` |
| `TextureSet` | Texture set | Diffuse, Normal, EnvironmentMaskOrSubsurfaceTint, Glow, Parallax, Environment | `ITextureSetGetter` |
| `EffectShader` | Effect shader | Flags, SourceTexture, FillTexture, HolesTexture, many animation parameters | `IEffectShaderGetter` |
| `VisualEffect` | Visual effect | ArtObject, Model | `IVisualEffectGetter` |
| `ArtObject` | Art object | Model, ObjectType | `IArtObjectGetter` |
| `ImageSpace` | Post-processing | HDR, Bloom, Cinematic parameters | `IImageSpaceGetter` |
| `ImageSpaceAdapter` | Image space modifier | Animatable, Duration, Flags, HDR/Bloom/Cinematic keyframes | `IImageSpaceAdapterGetter` |
| `LensFlare` | Lens flare | Sprites | `ILensFlareGetter` |
| `GodRays` | Volumetric lighting | Intensity, Color, various scattering parameters | `IGodRaysGetter` |
| `ShaderParticleGeometry` | Particle shader | Type, ParticleData, various particle parameters | `IShaderParticleGeometryGetter` |

### Crafting and Settlement

| Record Type | Description | Key Fields | Getter Interface |
|-------------|-------------|------------|-----------------|
| `ConstructibleObject` | Crafting recipe | CreatedObject, CreatedObjectCount, Components, Conditions | `IConstructibleObjectGetter` |
| `Component` | Crafting component | Name, ScrapItem | `IComponentGetter` |
| `AObjectModification` | Object modification | Name, Description, Model, Includes, Properties | `IAObjectModificationGetter` |
| `PackIn` | Pack-In template | Filter, CellReference | `IPackInGetter` |
| `InstanceNamingRules` | Dynamic naming rules | RuleSets | `IInstanceNamingRulesGetter` |

### World Objects

| Record Type | Description | Key Fields | Getter Interface |
|-------------|-------------|------------|-----------------|
| `Activator` | Interactive object | Name, Model, Script, Flags, WaterType, ActivateTextOverride, Keywords | `IActivatorGetter` |
| `TalkingActivator` | Speaking activator | Name, Model, VoiceType | `ITalkingActivatorGetter` |
| `Door` | Door object | Name, Model, OpenSound, CloseSound, Flags | `IDoorGetter` |
| `Flora` | Harvestable plant | Name, Model, Ingredient, HarvestSound, Seasons | `IFloraGetter` |
| `Furniture` | Furniture | Name, Model, Flags, MarkerParameters | `IFurnitureGetter` |
| `Light` | Light source | Name, Model, Time, Radius, Color, Flags, FalloffExponent, FOV, Value, Weight | `ILightGetter` |
| `Tree` | Tree object | Model, TrunkFlexibility, BranchFlexibility, LeafAmplitude | `ITreeGetter` |
| `Grass` | Ground cover | Model, Density, MinSlope, MaxSlope, WavePeriod | `IGrassGetter` |

### Weather and Climate

| Record Type | Description | Key Fields | Getter Interface |
|-------------|-------------|------------|-----------------|
| `Weather` | Weather type | Clouds, Colors, FogDistances, Sounds, ImageSpaces, GodRays, Precipitation | `IWeatherGetter` |
| `Climate` | Climate | Weathers, SunTexture, SunGlareTexture, Moons, Phases | `IClimateGetter` |
| `Water` | Water type | Name, Opacity, Flags, Material, DepthProperties, NoiseProperties | `IWaterGetter` |

### Navigation

| Record Type | Description | Key Fields | Getter Interface |
|-------------|-------------|------------|-----------------|
| `NavigationMesh` | Navmesh | Parent (Cell/Worldspace), Triangles, Vertices, EdgeLinks | `INavigationMeshGetter` |
| `NavigationMeshInfoMap` | Navmesh info map | NavigationMapInfos | `INavigationMeshInfoMapGetter` |
| `NavigationMeshObstacleManager` | Obstacle manager | SubObjects | `INavigationMeshObstacleManagerGetter` |

### Story Manager

| Record Type | Description | Key Fields | Getter Interface |
|-------------|-------------|------------|-----------------|
| `StoryManagerBranchNode` | Branch node | Flags, Conditions, Children | `IStoryManagerBranchNodeGetter` |
| `StoryManagerQuestNode` | Quest node | Quest, Flags, Conditions, Children | `IStoryManagerQuestNodeGetter` |
| `StoryManagerEventNode` | Event node | Type, Flags, Conditions, Children | `IStoryManagerEventNodeGetter` |

### Miscellaneous

| Record Type | Description | Key Fields | Getter Interface |
|-------------|-------------|------------|-----------------|
| `GameSetting` | Game setting | Subtypes: `GameSettingBool`, `GameSettingFloat`, `GameSettingInt`, `GameSettingString`, `GameSettingUInt` | `IGameSettingGetter` |
| `Global` | Global variable | Subtypes: `GlobalBool`, `GlobalFloat`, `GlobalInt`, `GlobalShort` | `IGlobalGetter` |
| `Keyword` | Keyword | Color, Type | `IKeywordGetter` |
| `FormList` | Form list | Items (list of FormLinks) | `IFormListGetter` |
| `LoadScreen` | Loading screen | Description, Conditions, CameraPath, Rotation, Zoom | `ILoadScreenGetter` |
| `Message` | UI message | Name, Description, Flags, Buttons | `IMessageGetter` |
| `DefaultObject` | Default object | UseOrObject | `IDefaultObjectGetter` |
| `DefaultObjectManager` | Default object manager | Objects | `IDefaultObjectManagerGetter` |
| `ADamageType` | Damage type | Spell, ActorValue | `IADamageTypeGetter` |
| `Debris` | Debris | Models | `IDebrisGetter` |
| `Explosion` | Explosion | Name, ObjectBounds, Force, Damage, Radius, Light, Sound, ImpactDataSet, ImageSpaceModifier | `IExplosionGetter` |
| `Projectile` | Projectile | Name, Model, Flags, Type, Speed, Range, Gravity, Light, Sound, Explosion | `IProjectileGetter` |
| `BodyPartData` | Body part data | Model, Parts | `IBodyPartDataGetter` |
| `ActorValueInformation` | Actor value info | Name, Abbreviation | `IActorValueInformationGetter` |
| `ColorRecord` | Color | Color, Conditions | `IColorRecordGetter` |
| `MaterialType` | Physical material | Parent, HavokDisplayColor, Flags | `IMaterialTypeGetter` |
| `MaterialObject` | Material object | Model, Properties | `IMaterialObjectGetter` |
| `MaterialSwap` | Material swap | Substitutions | `IMaterialSwapGetter` |
| `CollisionLayer` | Collision layer | Name, DebugColor, Flags, InteractableLayersList | `ICollisionLayerGetter` |
| `BendableSpline` | Bendable spline | DefaultNumberOfTiles, DefaultNumberOfSlices | `IBendableSplineGetter` |
| `Impact` | Impact | Model, DecalData, TextureSet, Sound1, Sound2 | `IImpactGetter` |
| `ImpactDataSet` | Impact data set | Impacts | `IImpactDataSetGetter` |
| `AnimatedObject` | Animated object | Model | `IAnimatedObjectGetter` |
| `HeadPart` | Head part | Name, Model, Flags, Type, ExtraParts, TextureSet | `IHeadPartGetter` |
| `EquipType` | Equipment type | SlotParents, Conditions, UseAllParents | `IEquipTypeGetter` |
| `MovementType` | Movement type | Name, Speeds, Data | `IMovementTypeGetter` |
| `AssociationType` | Association type | MaleParentTitle, FemaleParentTitle, MaleChildTitle, FemaleChildTitle | `IAssociationTypeGetter` |
| `Footstep` | Footstep | ImpactDataSet, Tag | `IFootstepGetter` |
| `FootstepSet` | Footstep set | WalkForwardSets, RunForwardSets, etc. | `IFootstepSetGetter` |
| `CameraShot` | Camera shot | Model, CameraAction, Location, Target, Duration, Flags | `ICameraShotGetter` |
| `CameraPath` | Camera path | Conditions, Shots, Flags | `ICameraPathGetter` |
| `LightingTemplate` | Lighting template | Ambient, Directional, FogNear, FogFar, colors and settings | `ILightingTemplateGetter` |
| `IdleMarker` | Idle marker | Flags, Animation count, Animations, Model | `IIdleMarkerGetter` |
| `AddonNode` | Addon node | Model, NodeIndex, AlwaysLoaded | `IAddonNodeGetter` |
| `SceneCollection` | Scene collection | Scenes | `ISceneCollectionGetter` |
| `AttractionRule` | Attraction rule | Radius, MinDelay, MaxDelay, RequiresKeyword | `IAttractionRuleGetter` |
| `ObjectVisibilityManager` | Visibility manager | Items | `IObjectVisibilityManagerGetter` |
| `LocationReferenceType` | Location ref type | Color | `ILocationReferenceTypeGetter` |
| `ActionRecord` | Action identifier | (base record only) | `IActionRecordGetter` |
| `Transform` | Transform preset | Position, Rotation, Scale, Zoom | `ITransformGetter` |
| `ReferenceGroup` | Reference group | Objects | `IReferenceGroupGetter` |
| `AimModel` | Aim model | MinConeDegrees, MaxConeDegrees, ConeIncrease, ConeDecrease, etc. | `IAimModelGetter` |
| `Zoom` | Scope zoom | Overlay, ImageSpaceModifier, CameraOffset, FOVMult | `IZoomGetter` |
| `SoundKeywordMapping` | Sound keyword map | Keywords, Sounds | `ISoundKeywordMappingGetter` |
| `AnimationSoundTagSet` | Anim sound tags | SoundTags | `IAnimationSoundTagSetGetter` |
| `Layer` | Layer | (base record) | `ILayerGetter` |

### Placed Reference Types

These represent placed instances of records within cells:

| Record Type | Description | Getter Interface |
|-------------|-------------|-----------------|
| `PlacedObject` (REFR) | General placed reference | `IPlacedObjectGetter` |
| `PlacedNpc` (ACHR) | Placed NPC | `IPlacedNpcGetter` |
| `PlacedArrow` (PARW) | Placed arrow projectile | `IPlacedArrowGetter` |
| `PlacedBarrier` (PBAR) | Placed barrier | `IPlacedBarrierGetter` |
| `PlacedBeam` (PBEA) | Placed beam projectile | `IPlacedBeamGetter` |
| `PlacedCone` (PCON) | Placed cone projectile | `IPlacedConeGetter` |
| `PlacedFlame` (PFLA) | Placed flame projectile | `IPlacedFlameGetter` |
| `PlacedHazard` (PHZD) | Placed hazard | `IPlacedHazardGetter` |
| `PlacedMissile` (PMIS) | Placed missile projectile | `IPlacedMissileGetter` |
| `PlacedTrap` (PGRE) | Placed trap | `IPlacedTrapGetter` |

All placed types share the common `IPlaced` / `IPlacedGetter` interface.

---

## Handwritten Partials (Custom Behavior)

The following non-generated files contain important custom logic:

### Record Enums and Flags

Most handwritten partials define **nested enums and flags** within their record type. Key examples:

**`Npc.cs`**: Defines `Npc.Flag` (Female, Essential, Respawn, Unique, IsGhost, Invulnerable, etc.), `Npc.AggressionType`, `Npc.ConfidenceType`, `Npc.ResponsibilityType`, `Npc.MoodType`, `Npc.AssistanceType`, `Npc.TemplateActorType`, `Npc.Property`. Also contains custom binary parsing logic for the NPC Level field (handling the `PcLevelMult` flag that encodes level type in a shared flags field) and morph key/value parsing.

**`Weapon.cs`**: Defines `Weapon.MajorFlag`, `Weapon.Flag` (PlayerOnly, NpcsUseAmmo, Automatic, BoltAction, HasScope, etc.), `Weapon.AnimationTypes`, `Weapon.PatternType`, `Weapon.MeleeSpeeds`, and an extensive `Weapon.Property` enum with 95 properties for the Object Modification system.

**`Quest.cs`**: Defines `Quest.MajorFlag`, `Quest.Flag` (StartGameEnabled, Completed, RunOnce, etc.), `Quest.TypeEnum` (MainQuest, BrotherhoodOfSteel, etc.). Contains complex custom binary parsing for quest fragments and aliases.

**`Cell.cs`**: Defines `Cell.MajorFlag` (NoPreVis, Persistent, OffLimits, CantWait), `Cell.Flag` (IsInteriorCell, HasWater, ShowSky, etc.). Contains extensive custom binary parsing for cell children groups (persistent/temporary placed objects, navigation meshes, landscapes, combined mesh references).

### Custom Binary Parsing

Several records have complex custom serialization logic (both reading and writing) in their handwritten partials:

- **`Cell.cs`** -- Most complex: handles CellChildren group parsing, persistent/temporary child groups, navmesh/landscape outlier parsing, combined mesh references (XCRI subrecord)
- **`Npc.cs`** -- PcLevelMult flag encoding in the Flags field, morph key/value split across MSDK/MSDV subrecords
- **`Quest.cs`** -- Fragment and alias custom parsing
- **`Worldspace.cs`** -- SubCells group hierarchy management
- **`Scene.cs`** / **`SceneAction.cs`** -- Scene action type dispatch
- **`Package.cs`** / **`PackageBranch.cs`** -- AI package data/target parsing
- **`DialogResponses.cs`** -- Dialog response adapter and fragment handling
- **`Perk.cs`** -- Perk effect type dispatch

### Abstract Base Types

Several abstract base types with handwritten partials manage type hierarchies:

- **`AMagicEffectArchetype.cs`** -- Base for magic effect archetypes (Bound, Cloak, EnhanceWeapon, Guide, Light, PeakValueMod, SpawnHazard, SummonCreature)
- **`APackageData.cs`** -- Base for package data types (Bool, Float, Int, Location, ObjectList, Target, Topic)
- **`APackageTarget.cs`** -- Base for package targets (Alias, Keyword, LinkedReference, ObjectID, ObjectType, Self, SpecificReference)
- **`APerkEffect.cs`** / **`APerkEntryPointEffect.cs`** -- Perk effect type hierarchy
- **`APlacedTrap.cs`** -- Base for placed trap types
- **`AQuestAlias.cs`** -- Base for quest aliases (Reference, Location, Collection)
- **`AStoryManagerNode.cs`** -- Base for story manager nodes (Branch, Quest, Event)

### Game Setting / Global Subtypes

Both `GameSetting` and `Global` use a type-dispatch pattern:

- **`GameSetting.cs`** -- dispatches to `GameSettingBool`, `GameSettingFloat`, `GameSettingInt`, `GameSettingString`, `GameSettingUInt`
- **`Global.cs`** -- dispatches to `GlobalBool`, `GlobalFloat`, `GlobalInt`, `GlobalShort`

---

## Key Enums (Standalone)

Located in `Enums/`:

| Enum | File | Description |
|------|------|-------------|
| `ActorValue` | `ActorValue.cs` | All actor values (Aggression, Confidence, Health, Strength, skills, etc.) |
| `ArmorType` | `ArmorType.cs` | Armor weight classes |
| `BipedObject` | `BipedObject.cs` | Biped body slot assignments (30+ slots) |
| `BlendOperation` | `BlendOperation.cs` | Texture blend operations |
| `CastType` | `CastType.cs` | Magic cast types (Fire and Forget, Concentration, etc.) |
| `CombatReaction` | `CombatReaction.cs` | Faction combat reaction types |
| `CompareOperator` | `CompareOperator.cs` | Condition comparison operators |
| `Emotion` | `Emotion.cs` | Dialogue emotion types |
| `EquipType` | `EquipType.cs` | Equipment slot enum |
| `GroupTypeEnum` | `GroupTypeEnum.cs` | Record group type identifiers |
| `Level` | `Level.cs` | Difficulty level enum |
| `LockLevel` | `LockLevel.cs` | Lock difficulty levels |
| `Perspective` | `Perspective.cs` | First/Third person perspective |
| `ReverbClass` | `ReverbClass.cs` | Reverb classification |
| `Size` | `Size.cs` | Size categories |
| `Skill` | `Skill.cs` | Skill identifiers |
| `SoundLevel` | `SoundLevel.cs` | Sound volume levels |
| `SpellDataFlag` | `SpellDataFlag.cs` | Spell data flags |
| `SpellType` | `SpellType.cs` | Spell categories |
| `Stagger` | `Stagger.cs` | Stagger magnitude levels |
| `TargetObjectType` | `TargetObjectType.cs` | Target object type filter |
| `TargetType` | `TargetType.cs` | Magic target types (Self, Touch, Aimed, etc.) |
| `TimeOfDay` | `TimeOfDay.cs` | Time of day categories |

---

## Supporting Infrastructure

### Fallout4Group\<T\>

**File:** `Records/Fallout4Group_Generated.cs` + `Records/Fallout4Group.cs`

A typed group container for major records. Provides:
- `RecordCache` -- Dictionary-based access by FormKey
- Enumeration over records
- Add/Remove/Clear operations

### Fallout4ListGroup\<T\>

**File:** `Records/Fallout4ListGroup_Generated.cs` + `Records/Fallout4ListGroup.cs`

A list-based group container used for Cell blocks (which use a block/sub-block hierarchy rather than flat record lists).

### Fallout4MajorRecord

**File:** `Records/Fallout4MajorRecord_Generated.cs` + `Records/Fallout4MajorRecord.cs`

Base class for all Fallout 4 major records. Extends the core `MajorRecord` with:
- `FormVersion` -- record format version
- Game-specific serialization

### Fallout4ModHeader

**File:** `Records/Fallout4ModHeader_Generated.cs` + `Records/Fallout4ModHeader.cs`

Plugin file header containing:
- `Flags` (including `HeaderFlag.Master`, `HeaderFlag.Small`)
- `Stats` (version, record count)
- `MasterReferences` -- list of master plugin dependencies
- `OverriddenForms` -- list of forms this plugin overrides
- `Description` -- plugin description text
